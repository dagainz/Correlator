# Correlator

Correlator is a *proof of concept* log processing system written in Python.

It is a system and framework used to read, processes, and take action based on log data generated by other systems
and/or applications.

Its architecture allows for extending and customizing the functionality of the main components of the system:

- The front-end, which is responsible for reading log records from a source
- Logic modules that are used detect patterns in log data and dispatch events in response.
- Event handlers that can selectively ignore or perform some action in response to events dispatched by any module or other part of the system.

A TCP based syslog server front-end is included with the system. A front-end that reads and processes log data from a file is also included, but as the format of the log file is not known in advance, it must be extended with code that understands the desired log file format and is able to parse it into records.

A single functional logic module is included as reference, and to provide a working example of monitoring
and taking action on a well known service, the Linux OpenSSH daemon.

There are several event handlers included that can take the following actions in response to events:

- Write the event details to the python log
- Save event details to CSV files
- Generate and send an email via SMTP. Messages are rendered using Mako. The details of the event are included in the Mako context.
- Send a simple SMS containing the event details by using twilio.


With all of these included components and their relatively simple API's, this project provides a complete system that
remotely processes and take action on syslog data generated by other systems over the network.

## High level features

- Modular architecture facilitates the separation and re-use of components that consume, detect patterns within,
and take action on log data. 
- RFC 5424 compliant TCP syslog server front end with packet capture and replay
- A configuration system that defines one or more logic modules and event handlers, plus their associated configuration, to be referenced by a name. This is a correlator application. Several applications may be defined at once, but only one may be active in a running instance. For an example, see the ssh-* applications included. They all use the sshd module for pattern detection, but they use different event handlers.
- Event handler credential management using python keyring.
- Disk file based persistence store to maintain system state between invocations (syslog server front end)

## Requirements

- Python 3.10
- A Unix like system, or Docker.

## Limitations and known issues

Many, such as:

- Single thread. An event handler blocking forever will halt the system.
- Limited exception handling, making the system fragile.
- The syslog server services a single TCP connection.
- The event system has no retry or even audit capability. Its fire-and-forget.


